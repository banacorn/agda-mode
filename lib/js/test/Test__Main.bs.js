// Generated by BUCKLESCRIPT VERSION 5.0.6, PLEASE EDIT WITH CARE
'use strict';

var Chai = require("chai");
var Curry = require("bs-platform/lib/js/curry.js");
var Rebase = require("@glennsl/rebase/lib/js/src/Rebase.bs.js");
var Expect$BsChai = require("bs-chai/lib/js/src/Expect.bs.js");
var Mocha$BsMocha = require("bs-mocha/lib/js/src/Mocha.bs.js");
var Assert$BsMocha = require("bs-mocha/lib/js/src/Assert.bs.js");
var Promise$BsMocha = require("bs-mocha/lib/js/src/Promise.bs.js");
var AgdaMode$AgdaMode = require("../src/AgdaMode.bs.js");
var Test__Util$AgdaMode = require("./Test__Util.bs.js");
var Caml_chrome_debugger = require("bs-platform/lib/js/caml_chrome_debugger.js");

Mocha$BsMocha.describe("Package")(undefined, undefined, undefined, (function (param) {
        Promise$BsMocha.before_each(undefined)(undefined, undefined, undefined, Test__Util$AgdaMode.Package[/* activate */2]);
        Promise$BsMocha.after_each(undefined)(undefined, undefined, undefined, Test__Util$AgdaMode.Package[/* deactivate */3]);
        Promise$BsMocha.after(undefined)(undefined, undefined, undefined, Test__Util$AgdaMode.Package[/* deactivate */3]);
        Promise$BsMocha.it("should be activated after triggering 'agda-mode:load' on .agda files")(undefined, undefined, undefined, (function (param) {
                Expect$BsChai.Combos[/* to_be_one_of */22](undefined, Test__Util$AgdaMode.Package[/* activeNames */0](/* () */0), Chai.expect("agda-mode").not);
                return Curry._1(Test__Util$AgdaMode.$$File[/* openAsset */1], "Blank1.agda").then((function (param) {
                                return Test__Util$AgdaMode.dispatch("agda-mode:load", param);
                              })).then((function (param) {
                              return Promise.resolve(Expect$BsChai.Combos[/* to_be_one_of */22](undefined, Test__Util$AgdaMode.Package[/* activeNames */0](/* () */0), Chai.expect("agda-mode")));
                            }));
              }));
        return Promise$BsMocha.it("should be activated after triggering 'agda-mode:load' on .lagda files")(undefined, undefined, undefined, (function (param) {
                      Expect$BsChai.Combos[/* to_be_one_of */22](undefined, Test__Util$AgdaMode.Package[/* activeNames */0](/* () */0), Chai.expect("agda-mode").not);
                      return Curry._1(Test__Util$AgdaMode.$$File[/* openAsset */1], "Blank2.lagda").then((function (param) {
                                      return Test__Util$AgdaMode.dispatch("agda-mode:load", param);
                                    })).then((function (param) {
                                    return Promise.resolve(Expect$BsChai.Combos[/* to_be_one_of */22](undefined, Test__Util$AgdaMode.Package[/* activeNames */0](/* () */0), Chai.expect("agda-mode")));
                                  }));
                    }));
      }));

Mocha$BsMocha.describe("Instances")(undefined, undefined, undefined, (function (param) {
        var instances = /* record */Caml_chrome_debugger.record(["contents"], [{ }]);
        var size = function (dict) {
          return Rebase.$$Array[/* length */16](Object.keys(dict[0]));
        };
        Promise$BsMocha.it("should have no instances before opening any files")(undefined, undefined, undefined, (function (param) {
                instances[0] = AgdaMode$AgdaMode.activate(/* () */0);
                return Promise.resolve(Assert$BsMocha.equal(undefined, size(instances), 0));
              }));
        Promise$BsMocha.it("should respect the number of opened .agda file")(undefined, undefined, undefined, (function (param) {
                return Curry._1(Test__Util$AgdaMode.$$File[/* openAsset */1], "Blank1.agda").then((function (editor) {
                                Assert$BsMocha.equal(undefined, size(instances), 1);
                                var pane = atom.workspace.getActivePane();
                                return pane.destroyItem(editor, true);
                              })).then((function (destroyed) {
                              Assert$BsMocha.equal(undefined, size(instances), destroyed ? 0 : 1);
                              return Promise.resolve(/* () */0);
                            }));
              }));
        Promise$BsMocha.it("should respect the number of opened .lagda file")(undefined, undefined, undefined, (function (param) {
                return Curry._1(Test__Util$AgdaMode.$$File[/* openAsset */1], "Blank2.lagda").then((function (editor) {
                                Assert$BsMocha.equal(undefined, size(instances), 1);
                                var pane = atom.workspace.getActivePane();
                                return pane.destroyItem(editor, true);
                              })).then((function (destroyed) {
                              Assert$BsMocha.equal(undefined, size(instances), destroyed ? 0 : 1);
                              return Promise.resolve(/* () */0);
                            }));
              }));
        return Promise$BsMocha.it("should include '.agda' in the classlist")(undefined, undefined, undefined, (function (param) {
                      return Curry._1(Test__Util$AgdaMode.$$File[/* openAsset */1], "Blank1.agda").then((function (editor) {
                                    Assert$BsMocha.ok(atom.views.getView(editor).classList.contains("agda"));
                                    return Promise.resolve(/* () */0);
                                  }));
                    }));
      }));

/*  Not a pure module */
