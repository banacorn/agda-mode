// Generated by BUCKLESCRIPT VERSION 5.0.6, PLEASE EDIT WITH CARE
'use strict';

var Events = require("events");
var Caml_option = require("bs-platform/lib/js/caml_option.js");
var Async$AgdaMode = require("./Async.bs.js");
var Caml_chrome_debugger = require("bs-platform/lib/js/caml_chrome_debugger.js");

function make(param) {
  var emitter = new Events.EventEmitter();
  var resource = /* record */Caml_chrome_debugger.record(["contents"], [undefined]);
  var acquire = function (param) {
    var match = resource[0];
    if (match !== undefined) {
      return Async$AgdaMode.resolve(Caml_option.valFromOption(match));
    } else {
      return Async$AgdaMode.make((function (resolve, param) {
                    emitter.on("supply", resolve);
                    return /* () */0;
                  }));
    }
  };
  var supply = function (x) {
    resource[0] = Caml_option.some(x);
    emitter.emit("supply", x);
    return /* () */0;
  };
  return /* record */Caml_chrome_debugger.record([
            "acquire",
            "supply"
          ], [
            acquire,
            supply
          ]);
}

exports.make = make;
/* events Not a pure module */
