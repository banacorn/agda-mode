// Generated by BUCKLESCRIPT VERSION 5.0.6, PLEASE EDIT WITH CARE
'use strict';

var Curry = require("bs-platform/lib/js/curry.js");
var Rebase = require("@glennsl/rebase/lib/js/src/Rebase.bs.js");
var Js_dict = require("bs-platform/lib/js/js_dict.js");
var Mocha$BsMocha = require("bs-mocha/lib/js/src/Mocha.bs.js");
var Assert$BsMocha = require("bs-mocha/lib/js/src/Assert.bs.js");
var Promise$BsMocha = require("bs-mocha/lib/js/src/Promise.bs.js");
var AgdaMode$AgdaMode = require("../src/AgdaMode.bs.js");
var Test__Util$AgdaMode = require("./Test__Util.bs.js");

Mocha$BsMocha.describe("Input Method")(undefined, undefined, undefined, (function (param) {
        Promise$BsMocha.before(undefined)(undefined, undefined, undefined, Test__Util$AgdaMode.Package[/* activate */2]);
        Promise$BsMocha.after(undefined)(undefined, undefined, undefined, Test__Util$AgdaMode.Package[/* deactivate */3]);
        Promise$BsMocha.after_each(undefined)(undefined, undefined, undefined, (function (param) {
                Rebase.$$Array[/* forEach */8]((function (param) {
                        return Curry._1(param[1][/* view */2][/* activateInputMethod */10], false);
                      }), Js_dict.entries(AgdaMode$AgdaMode.instances));
                return Promise.resolve(/* () */0);
              }));
        Promise$BsMocha.it("should not add class '.agda-mode-input-method-activated' to the editor element before triggering")(undefined, undefined, undefined, (function (param) {
                return Curry._1(Test__Util$AgdaMode.$$File[/* openAsset */1], "Blank1.agda").then((function (param) {
                                return Test__Util$AgdaMode.dispatch("agda-mode:load", param);
                              })).then((function (editor) {
                              var element = atom.views.getView(editor);
                              Assert$BsMocha.equal(undefined, false, element.classList.contains("agda-mode-input-method-activated"));
                              return Promise.resolve(/* () */0);
                            }));
              }));
        Promise$BsMocha.it("should add class '.agda-mode-input-method-activated' to the editor element after triggering")(undefined, undefined, undefined, (function (param) {
                return Curry._1(Test__Util$AgdaMode.$$File[/* openAsset */1], "Blank1.agda").then((function (param) {
                                return Test__Util$AgdaMode.dispatch("agda-mode:load", param);
                              })).then((function (editor) {
                              var element = atom.views.getView(editor);
                              var result = Test__Util$AgdaMode.getInstance(editor).then((function (instance) {
                                        return Curry._1(instance[/* view */2][/* onInputMethodActivationChange */11], /* () */0).then((function (param) {
                                                      if (param.tag || !param[0]) {
                                                        return Promise.reject([
                                                                    Test__Util$AgdaMode.Exn,
                                                                    "input method not activated for some reason"
                                                                  ]);
                                                      } else {
                                                        return Promise.resolve(/* () */0);
                                                      }
                                                    }));
                                      })).then((function (param) {
                                      Assert$BsMocha.ok(element.classList.contains("agda-mode-input-method-activated"));
                                      return Promise.resolve(/* () */0);
                                    }));
                              var press = function (key) {
                                return atom.keymaps.constructor.buildKeydownEvent(key, {
                                            ctrl: false,
                                            alt: false,
                                            shift: false,
                                            cmd: false,
                                            which: 0,
                                            target: element
                                          });
                              };
                              atom.keymaps.handleKeyboardEvent(press("\\"));
                              return result;
                            }));
              }));
        return Promise$BsMocha.it("should not add class '.agda-mode-input-method-activated' to the editor element before triggering")(undefined, undefined, undefined, (function (param) {
                      return Curry._1(Test__Util$AgdaMode.$$File[/* openAsset */1], "Blank1.agda").then((function (param) {
                                      return Test__Util$AgdaMode.dispatch("agda-mode:load", param);
                                    })).then((function (editor) {
                                    var element = atom.views.getView(editor);
                                    Assert$BsMocha.equal(undefined, false, element.classList.contains("agda-mode-input-method-activated"));
                                    return Promise.resolve(/* () */0);
                                  }));
                    }));
      }));

/*  Not a pure module */
