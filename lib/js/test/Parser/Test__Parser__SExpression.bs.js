// Generated by BUCKLESCRIPT VERSION 5.0.6, PLEASE EDIT WITH CARE
'use strict';

var Curry = require("bs-platform/lib/js/curry.js");
var Rebase = require("@glennsl/rebase/lib/js/src/Rebase.bs.js");
var Mocha$BsMocha = require("bs-mocha/lib/js/src/Mocha.bs.js");
var Assert$BsMocha = require("bs-mocha/lib/js/src/Assert.bs.js");
var Parser$AgdaMode = require("../../src/Parser.bs.js");
var Promise$BsMocha = require("bs-mocha/lib/js/src/Promise.bs.js");
var Connection$AgdaMode = require("../../src/Connection.bs.js");
var Test__Util$AgdaMode = require("../Test__Util.bs.js");
var Caml_chrome_debugger = require("bs-platform/lib/js/caml_chrome_debugger.js");

function parseSExpression(input) {
  var output = /* record */Caml_chrome_debugger.record(["contents"], [[]]);
  var parser = Parser$AgdaMode.SExpression[/* makeIncr */5]((function (param) {
          if (param) {
            var match = param[0];
            if (match.tag) {
              return Assert$BsMocha.fail("Failed when parsing S-expression: " + Parser$AgdaMode.$$Error[/* toString */0](match[0]));
            } else {
              output[0].push(match[0]);
              return /* () */0;
            }
          } else {
            return /* () */0;
          }
        }));
  Connection$AgdaMode.parseAgdaOutput(parser, input);
  return output[0];
}

Mocha$BsMocha.describe("when parsing S-expressions")(undefined, undefined, undefined, (function (param) {
        return Rebase.$$Array[/* forEach */8]((function (filepath) {
                      return Promise$BsMocha.it("should golden test " + filepath)(undefined, undefined, undefined, (function (param) {
                                    var partial_arg = Curry._2(Rebase.Fn[/* >> */6], parseSExpression, Test__Util$AgdaMode.serializeWith(Parser$AgdaMode.SExpression[/* toString */0]));
                                    var partial_arg$1 = Test__Util$AgdaMode.Golden[/* map */1];
                                    var partial_arg$2 = Curry._2(Rebase.Fn[/* >> */6], (function (param) {
                                            return partial_arg$1(partial_arg, param);
                                          }), Test__Util$AgdaMode.Golden[/* compare */3]);
                                    return Test__Util$AgdaMode.Golden[/* readFile */2](filepath).then(Curry.__1(partial_arg$2));
                                  }));
                    }), Test__Util$AgdaMode.getGoldenFilepathsSync("test/Parser/SExpression"));
      }));

exports.parseSExpression = parseSExpression;
/*  Not a pure module */
