// Generated by BUCKLESCRIPT, PLEASE EDIT WITH CARE
'use strict';

var Curry = require("bs-platform/lib/js/curry.js");
var Rebase = require("@glennsl/rebase/lib/js/src/Rebase.bs.js");
var $$Promise = require("reason-promise/lib/js/src/js/promise.js");
var Goal$AgdaMode = require("../Goal.bs.js");
var Task$AgdaMode = require("./Task.bs.js");
var Command$AgdaMode = require("../Command.bs.js");
var Editors$AgdaMode = require("../Editors.bs.js");
var Translator$AgdaMode = require("../View/Panel/InputMethod/Translator.bs.js");
var Caml_chrome_debugger = require("bs-platform/lib/js/caml_chrome_debugger.js");
var Type__Location$AgdaMode = require("../Type/Type__Location.bs.js");
var Instance__Goals$AgdaMode = require("../Instance/Instance__Goals.bs.js");
var Instance__TextEditors$AgdaMode = require("../Instance/Instance__TextEditors.bs.js");
var Instance__Highlightings$AgdaMode = require("../Instance/Instance__Highlightings.bs.js");

function handle(command) {
  if (typeof command === "number") {
    switch (command) {
      case /* Load */0 :
          return /* :: */Caml_chrome_debugger.simpleVariant("::", [
                    /* Editor */Caml_chrome_debugger.variant("Editor", 4, [/* Save */0]),
                    /* :: */Caml_chrome_debugger.simpleVariant("::", [
                        /* Activate */1,
                        /* :: */Caml_chrome_debugger.simpleVariant("::", [
                            /* WithInstance */Caml_chrome_debugger.variant("WithInstance", 0, [(function (instance) {
                                    instance[/* isLoaded */3] = true;
                                    return Task$AgdaMode.$$return(/* [] */0);
                                  })]),
                            /* :: */Caml_chrome_debugger.simpleVariant("::", [
                                /* Display */Caml_chrome_debugger.variant("Display", 2, [
                                    "Connecting ...",
                                    /* PlainText */0,
                                    /* Emacs */Caml_chrome_debugger.variant("Emacs", 0, [/* PlainText */Caml_chrome_debugger.variant("PlainText", 8, [""])])
                                  ]),
                                /* :: */Caml_chrome_debugger.simpleVariant("::", [
                                    /* SendRequest */Caml_chrome_debugger.variant("SendRequest", 8, [/* Load */0]),
                                    /* [] */0
                                  ])
                              ])
                          ])
                      ])
                  ]);
      case /* Quit */1 :
          return /* :: */Caml_chrome_debugger.simpleVariant("::", [
                    /* Disconnect */0,
                    /* :: */Caml_chrome_debugger.simpleVariant("::", [
                        /* WithInstance */Caml_chrome_debugger.variant("WithInstance", 0, [(function (instance) {
                                Instance__Goals$AgdaMode.destroyAll(instance);
                                Instance__Highlightings$AgdaMode.destroyAll(instance);
                                instance[/* isLoaded */3] = false;
                                return Task$AgdaMode.$$return(/* [] */0);
                              })]),
                        /* :: */Caml_chrome_debugger.simpleVariant("::", [
                            /* Deactivate */2,
                            /* [] */0
                          ])
                      ])
                  ]);
      case /* Restart */2 :
          return /* :: */Caml_chrome_debugger.simpleVariant("::", [
                    /* Disconnect */0,
                    /* :: */Caml_chrome_debugger.simpleVariant("::", [
                        /* SendRequest */Caml_chrome_debugger.variant("SendRequest", 8, [/* Load */0]),
                        /* [] */0
                      ])
                  ]);
      case /* Abort */3 :
          return /* :: */Caml_chrome_debugger.simpleVariant("::", [
                    /* SendRequest */Caml_chrome_debugger.variant("SendRequest", 8, [/* Abort */1]),
                    /* [] */0
                  ]);
      case /* Compile */4 :
          return /* :: */Caml_chrome_debugger.simpleVariant("::", [
                    /* SendRequest */Caml_chrome_debugger.variant("SendRequest", 8, [/* Compile */2]),
                    /* [] */0
                  ]);
      case /* ToggleDisplayOfImplicitArguments */5 :
          return /* :: */Caml_chrome_debugger.simpleVariant("::", [
                    /* SendRequest */Caml_chrome_debugger.variant("SendRequest", 8, [/* ToggleDisplayOfImplicitArguments */3]),
                    /* [] */0
                  ]);
      case /* SolveConstraints */6 :
          return /* :: */Caml_chrome_debugger.simpleVariant("::", [
                    /* SendRequest */Caml_chrome_debugger.variant("SendRequest", 8, [/* SolveConstraints */4]),
                    /* [] */0
                  ]);
      case /* ShowConstraints */7 :
          return /* :: */Caml_chrome_debugger.simpleVariant("::", [
                    /* SendRequest */Caml_chrome_debugger.variant("SendRequest", 8, [/* ShowConstraints */5]),
                    /* [] */0
                  ]);
      case /* ShowGoals */8 :
          return /* :: */Caml_chrome_debugger.simpleVariant("::", [
                    /* SendRequest */Caml_chrome_debugger.variant("SendRequest", 8, [/* ShowGoals */6]),
                    /* [] */0
                  ]);
      case /* NextGoal */9 :
          return /* :: */Caml_chrome_debugger.simpleVariant("::", [
                    /* Goals */Caml_chrome_debugger.variant("Goals", 5, [/* JumpToTheNext */0]),
                    /* [] */0
                  ]);
      case /* PreviousGoal */10 :
          return /* :: */Caml_chrome_debugger.simpleVariant("::", [
                    /* Goals */Caml_chrome_debugger.variant("Goals", 5, [/* JumpToThePrevious */1]),
                    /* [] */0
                  ]);
      case /* ToggleDocking */11 :
          return /* :: */Caml_chrome_debugger.simpleVariant("::", [
                    /* WithInstance */Caml_chrome_debugger.variant("WithInstance", 0, [(function (instance) {
                            return $$Promise.map(Curry._1(instance[/* view */1][/* toggleDocking */2], /* () */0), (function (param) {
                                          return /* Ok */Caml_chrome_debugger.variant("Ok", 0, [/* [] */0]);
                                        }));
                          })]),
                    /* [] */0
                  ]);
      case /* WhyInScope */12 :
          return /* :: */Caml_chrome_debugger.simpleVariant("::", [
                    /* WithInstance */Caml_chrome_debugger.variant("WithInstance", 0, [(function (instance) {
                            var selectedText = instance[/* editors */0][/* source */1].getSelectedText();
                            if (Rebase.$$String.isEmpty(selectedText)) {
                              return Task$AgdaMode.$$return(/* :: */Caml_chrome_debugger.simpleVariant("::", [
                                            /* Inquire */Caml_chrome_debugger.variant("Inquire", 3, [
                                                "Scope info",
                                                "name:",
                                                "",
                                                (function (expr) {
                                                    return /* :: */Caml_chrome_debugger.simpleVariant("::", [
                                                              /* Goals */Caml_chrome_debugger.variant("Goals", 5, [/* GetPointed */Caml_chrome_debugger.variant("GetPointed", 0, [(function (goal) {
                                                                          return /* :: */Caml_chrome_debugger.simpleVariant("::", [
                                                                                    /* SendRequest */Caml_chrome_debugger.variant("SendRequest", 8, [/* WhyInScope */Caml_chrome_debugger.variant("WhyInScope", 0, [
                                                                                            expr,
                                                                                            goal
                                                                                          ])]),
                                                                                    /* [] */0
                                                                                  ]);
                                                                        })])]),
                                                              /* [] */0
                                                            ]);
                                                  })
                                              ]),
                                            /* [] */0
                                          ]));
                            } else {
                              return Task$AgdaMode.$$return(/* :: */Caml_chrome_debugger.simpleVariant("::", [
                                            /* SendRequest */Caml_chrome_debugger.variant("SendRequest", 8, [/* WhyInScopeGlobal */Caml_chrome_debugger.variant("WhyInScopeGlobal", 1, [selectedText])]),
                                            /* [] */0
                                          ]));
                            }
                          })]),
                    /* [] */0
                  ]);
      case /* Give */13 :
          return /* :: */Caml_chrome_debugger.simpleVariant("::", [
                    /* Goals */Caml_chrome_debugger.variant("Goals", 5, [/* GetPointed */Caml_chrome_debugger.variant("GetPointed", 0, [(function (goal) {
                                if (Goal$AgdaMode.isEmpty(goal)) {
                                  return /* :: */Caml_chrome_debugger.simpleVariant("::", [
                                            /* Inquire */Caml_chrome_debugger.variant("Inquire", 3, [
                                                "Give",
                                                "expression to give:",
                                                "",
                                                (function (expr) {
                                                    Goal$AgdaMode.setContent(expr, goal);
                                                    return /* :: */Caml_chrome_debugger.simpleVariant("::", [
                                                              /* SendRequest */Caml_chrome_debugger.variant("SendRequest", 8, [/* Give */Caml_chrome_debugger.variant("Give", 9, [goal])]),
                                                              /* [] */0
                                                            ]);
                                                  })
                                              ]),
                                            /* [] */0
                                          ]);
                                } else {
                                  return /* :: */Caml_chrome_debugger.simpleVariant("::", [
                                            /* SendRequest */Caml_chrome_debugger.variant("SendRequest", 8, [/* Give */Caml_chrome_debugger.variant("Give", 9, [goal])]),
                                            /* [] */0
                                          ]);
                                }
                              })])]),
                    /* [] */0
                  ]);
      case /* Refine */14 :
          return /* :: */Caml_chrome_debugger.simpleVariant("::", [
                    /* Goals */Caml_chrome_debugger.variant("Goals", 5, [/* GetPointed */Caml_chrome_debugger.variant("GetPointed", 0, [(function (goal) {
                                return /* :: */Caml_chrome_debugger.simpleVariant("::", [
                                          /* SendRequest */Caml_chrome_debugger.variant("SendRequest", 8, [/* Refine */Caml_chrome_debugger.variant("Refine", 10, [goal])]),
                                          /* [] */0
                                        ]);
                              })])]),
                    /* [] */0
                  ]);
      case /* Auto */15 :
          return /* :: */Caml_chrome_debugger.simpleVariant("::", [
                    /* Goals */Caml_chrome_debugger.variant("Goals", 5, [/* GetPointed */Caml_chrome_debugger.variant("GetPointed", 0, [(function (goal) {
                                return /* :: */Caml_chrome_debugger.simpleVariant("::", [
                                          /* SendRequest */Caml_chrome_debugger.variant("SendRequest", 8, [/* Auto */Caml_chrome_debugger.variant("Auto", 11, [goal])]),
                                          /* [] */0
                                        ]);
                              })])]),
                    /* [] */0
                  ]);
      case /* Case */16 :
          return /* :: */Caml_chrome_debugger.simpleVariant("::", [
                    /* Goals */Caml_chrome_debugger.variant("Goals", 5, [/* GetPointed */Caml_chrome_debugger.variant("GetPointed", 0, [(function (goal) {
                                if (Goal$AgdaMode.isEmpty(goal)) {
                                  return /* :: */Caml_chrome_debugger.simpleVariant("::", [
                                            /* Inquire */Caml_chrome_debugger.variant("Inquire", 3, [
                                                "Case",
                                                "expression to case:",
                                                "",
                                                (function (expr) {
                                                    Goal$AgdaMode.setContent(expr, goal);
                                                    return /* :: */Caml_chrome_debugger.simpleVariant("::", [
                                                              /* SendRequest */Caml_chrome_debugger.variant("SendRequest", 8, [/* Case */Caml_chrome_debugger.variant("Case", 12, [goal])]),
                                                              /* [] */0
                                                            ]);
                                                  })
                                              ]),
                                            /* [] */0
                                          ]);
                                } else {
                                  return /* :: */Caml_chrome_debugger.simpleVariant("::", [
                                            /* SendRequest */Caml_chrome_debugger.variant("SendRequest", 8, [/* Case */Caml_chrome_debugger.variant("Case", 12, [goal])]),
                                            /* [] */0
                                          ]);
                                }
                              })])]),
                    /* [] */0
                  ]);
      case /* QuerySymbol */17 :
          return /* :: */Caml_chrome_debugger.simpleVariant("::", [
                    /* WithInstance */Caml_chrome_debugger.variant("WithInstance", 0, [(function (instance) {
                            var selected = Editors$AgdaMode.getSelectedSymbol(instance[/* editors */0]);
                            var getSymbol = Rebase.$$String.isEmpty(Rebase.$$String.trim(selected)) ? $$Promise.flatMap(Curry._1(instance[/* view */1][/* activate */0], /* () */0), (function (param) {
                                      return Curry._3(instance[/* view */1][/* inquire */4], "Lookup Unicode Symbol Input Sequence", "symbol to lookup:", "");
                                    })) : $$Promise.resolved(/* Ok */Caml_chrome_debugger.variant("Ok", 0, [selected]));
                            $$Promise.getOk(getSymbol, (function (symbol) {
                                    return Rebase.$$Option.forEach((function (sequences) {
                                                  Curry._3(instance[/* view */1][/* display */3], "Input sequence for " + symbol, /* PlainText */0, /* Emacs */Caml_chrome_debugger.variant("Emacs", 0, [/* PlainText */Caml_chrome_debugger.variant("PlainText", 8, [Rebase.$$String.joinWith("\n", Rebase.List.fromArray(sequences))])]));
                                                  return /* () */0;
                                                }), Translator$AgdaMode.lookup(symbol));
                                  }));
                            return $$Promise.resolved(/* Ok */Caml_chrome_debugger.variant("Ok", 0, [/* [] */0]));
                          })]),
                    /* [] */0
                  ]);
      case /* GotoDefinition */18 :
          return /* :: */Caml_chrome_debugger.simpleVariant("::", [
                    /* WithInstance */Caml_chrome_debugger.variant("WithInstance", 0, [(function (instance) {
                            if (instance[/* isLoaded */3]) {
                              return $$Promise.flatMap(Instance__TextEditors$AgdaMode.restoreCursorPosition((function (param) {
                                                return $$Promise.resolved(Editors$AgdaMode.getSelectedTextNode(instance[/* editors */0]));
                                              }), instance), (function (name) {
                                            return Instance__TextEditors$AgdaMode.handleOutOfGoal($$Promise.mapOk(Instance__TextEditors$AgdaMode.getPointedGoal(instance), (function (goal) {
                                                              return /* :: */Caml_chrome_debugger.simpleVariant("::", [
                                                                        /* SendRequest */Caml_chrome_debugger.variant("SendRequest", 8, [/* GotoDefinition */Caml_chrome_debugger.variant("GotoDefinition", 17, [
                                                                                name,
                                                                                goal
                                                                              ])]),
                                                                        /* [] */0
                                                                      ]);
                                                            })), (function (param) {
                                                          return $$Promise.resolved(/* Ok */Caml_chrome_debugger.variant("Ok", 0, [/* :: */Caml_chrome_debugger.simpleVariant("::", [
                                                                            /* SendRequest */Caml_chrome_debugger.variant("SendRequest", 8, [/* GotoDefinitionGlobal */Caml_chrome_debugger.variant("GotoDefinitionGlobal", 18, [name])]),
                                                                            /* [] */0
                                                                          ])]));
                                                        }));
                                          }));
                            } else {
                              return $$Promise.resolved(/* Ok */Caml_chrome_debugger.variant("Ok", 0, [/* :: */Caml_chrome_debugger.simpleVariant("::", [
                                                /* DispatchCommand */Caml_chrome_debugger.variant("DispatchCommand", 7, [/* Load */0]),
                                                /* [] */0
                                              ])]));
                            }
                          })]),
                    /* [] */0
                  ]);
      
    }
  } else {
    switch (command.tag | 0) {
      case /* SearchAbout */0 :
          var normalization = command[0];
          return /* :: */Caml_chrome_debugger.simpleVariant("::", [
                    /* Inquire */Caml_chrome_debugger.variant("Inquire", 3, [
                        "Searching through definitions [" + (Command$AgdaMode.Normalization.toString(normalization) + "]"),
                        "expression to search:",
                        "",
                        (function (expr) {
                            return /* :: */Caml_chrome_debugger.simpleVariant("::", [
                                      /* SendRequest */Caml_chrome_debugger.variant("SendRequest", 8, [/* SearchAbout */Caml_chrome_debugger.variant("SearchAbout", 2, [
                                              normalization,
                                              expr
                                            ])]),
                                      /* [] */0
                                    ]);
                          })
                      ]),
                    /* [] */0
                  ]);
      case /* InferType */1 :
          var normalization$1 = command[0];
          return /* :: */Caml_chrome_debugger.simpleVariant("::", [
                    /* Goals */Caml_chrome_debugger.variant("Goals", 5, [/* GetPointedOr */Caml_chrome_debugger.variant("GetPointedOr", 1, [
                            (function (goal) {
                                if (Goal$AgdaMode.isEmpty(goal)) {
                                  return /* :: */Caml_chrome_debugger.simpleVariant("::", [
                                            /* Inquire */Caml_chrome_debugger.variant("Inquire", 3, [
                                                "Infer type [" + (Command$AgdaMode.Normalization.toString(normalization$1) + "]"),
                                                "expression to infer:",
                                                "",
                                                (function (expr) {
                                                    return /* :: */Caml_chrome_debugger.simpleVariant("::", [
                                                              /* SendRequest */Caml_chrome_debugger.variant("SendRequest", 8, [/* InferType */Caml_chrome_debugger.variant("InferType", 3, [
                                                                      normalization$1,
                                                                      expr,
                                                                      goal
                                                                    ])]),
                                                              /* [] */0
                                                            ]);
                                                  })
                                              ]),
                                            /* [] */0
                                          ]);
                                } else {
                                  var expr = Goal$AgdaMode.getContent(goal);
                                  return /* :: */Caml_chrome_debugger.simpleVariant("::", [
                                            /* SendRequest */Caml_chrome_debugger.variant("SendRequest", 8, [/* InferType */Caml_chrome_debugger.variant("InferType", 3, [
                                                    normalization$1,
                                                    expr,
                                                    goal
                                                  ])]),
                                            /* [] */0
                                          ]);
                                }
                              }),
                            (function (param) {
                                return /* :: */Caml_chrome_debugger.simpleVariant("::", [
                                          /* Inquire */Caml_chrome_debugger.variant("Inquire", 3, [
                                              "Infer type [" + (Command$AgdaMode.Normalization.toString(normalization$1) + "]"),
                                              "expression to infer:",
                                              "",
                                              (function (expr) {
                                                  return /* :: */Caml_chrome_debugger.simpleVariant("::", [
                                                            /* SendRequest */Caml_chrome_debugger.variant("SendRequest", 8, [/* InferTypeGlobal */Caml_chrome_debugger.variant("InferTypeGlobal", 4, [
                                                                    normalization$1,
                                                                    expr
                                                                  ])]),
                                                            /* [] */0
                                                          ]);
                                                })
                                            ]),
                                          /* [] */0
                                        ]);
                              })
                          ])]),
                    /* [] */0
                  ]);
      case /* ModuleContents */2 :
          var normalization$2 = command[0];
          return /* :: */Caml_chrome_debugger.simpleVariant("::", [
                    /* Inquire */Caml_chrome_debugger.variant("Inquire", 3, [
                        "Module contents [" + (Command$AgdaMode.Normalization.toString(normalization$2) + "]"),
                        "module name:",
                        "",
                        (function (expr) {
                            return /* :: */Caml_chrome_debugger.simpleVariant("::", [
                                      /* Goals */Caml_chrome_debugger.variant("Goals", 5, [/* GetPointedOr */Caml_chrome_debugger.variant("GetPointedOr", 1, [
                                              (function (goal) {
                                                  return /* :: */Caml_chrome_debugger.simpleVariant("::", [
                                                            /* SendRequest */Caml_chrome_debugger.variant("SendRequest", 8, [/* ModuleContents */Caml_chrome_debugger.variant("ModuleContents", 5, [
                                                                    normalization$2,
                                                                    expr,
                                                                    goal
                                                                  ])]),
                                                            /* [] */0
                                                          ]);
                                                }),
                                              (function (param) {
                                                  return /* :: */Caml_chrome_debugger.simpleVariant("::", [
                                                            /* SendRequest */Caml_chrome_debugger.variant("SendRequest", 8, [/* ModuleContentsGlobal */Caml_chrome_debugger.variant("ModuleContentsGlobal", 6, [
                                                                    normalization$2,
                                                                    expr
                                                                  ])]),
                                                            /* [] */0
                                                          ]);
                                                })
                                            ])]),
                                      /* [] */0
                                    ]);
                          })
                      ]),
                    /* [] */0
                  ]);
      case /* ComputeNormalForm */3 :
          var computeMode = command[0];
          return /* :: */Caml_chrome_debugger.simpleVariant("::", [
                    /* Goals */Caml_chrome_debugger.variant("Goals", 5, [/* GetPointedOr */Caml_chrome_debugger.variant("GetPointedOr", 1, [
                            (function (goal) {
                                if (Goal$AgdaMode.isEmpty(goal)) {
                                  return /* :: */Caml_chrome_debugger.simpleVariant("::", [
                                            /* Inquire */Caml_chrome_debugger.variant("Inquire", 3, [
                                                "Compute normal form",
                                                "expression to normalize:",
                                                "",
                                                (function (expr) {
                                                    return /* :: */Caml_chrome_debugger.simpleVariant("::", [
                                                              /* SendRequest */Caml_chrome_debugger.variant("SendRequest", 8, [/* ComputeNormalForm */Caml_chrome_debugger.variant("ComputeNormalForm", 7, [
                                                                      computeMode,
                                                                      expr,
                                                                      goal
                                                                    ])]),
                                                              /* [] */0
                                                            ]);
                                                  })
                                              ]),
                                            /* [] */0
                                          ]);
                                } else {
                                  var expr = Goal$AgdaMode.getContent(goal);
                                  return /* :: */Caml_chrome_debugger.simpleVariant("::", [
                                            /* SendRequest */Caml_chrome_debugger.variant("SendRequest", 8, [/* ComputeNormalForm */Caml_chrome_debugger.variant("ComputeNormalForm", 7, [
                                                    computeMode,
                                                    expr,
                                                    goal
                                                  ])]),
                                            /* [] */0
                                          ]);
                                }
                              }),
                            (function (param) {
                                return /* :: */Caml_chrome_debugger.simpleVariant("::", [
                                          /* Inquire */Caml_chrome_debugger.variant("Inquire", 3, [
                                              "Compute normal form",
                                              "expression to normalize:",
                                              "",
                                              (function (expr) {
                                                  return /* :: */Caml_chrome_debugger.simpleVariant("::", [
                                                            /* SendRequest */Caml_chrome_debugger.variant("SendRequest", 8, [/* ComputeNormalFormGlobal */Caml_chrome_debugger.variant("ComputeNormalFormGlobal", 8, [
                                                                    computeMode,
                                                                    expr
                                                                  ])]),
                                                            /* [] */0
                                                          ]);
                                                })
                                            ]),
                                          /* [] */0
                                        ]);
                              })
                          ])]),
                    /* [] */0
                  ]);
      case /* GoalType */4 :
          var normalization$3 = command[0];
          return /* :: */Caml_chrome_debugger.simpleVariant("::", [
                    /* Goals */Caml_chrome_debugger.variant("Goals", 5, [/* GetPointed */Caml_chrome_debugger.variant("GetPointed", 0, [(function (goal) {
                                return /* :: */Caml_chrome_debugger.simpleVariant("::", [
                                          /* SendRequest */Caml_chrome_debugger.variant("SendRequest", 8, [/* GoalType */Caml_chrome_debugger.variant("GoalType", 13, [
                                                  normalization$3,
                                                  goal
                                                ])]),
                                          /* [] */0
                                        ]);
                              })])]),
                    /* [] */0
                  ]);
      case /* Context */5 :
          var normalization$4 = command[0];
          return /* :: */Caml_chrome_debugger.simpleVariant("::", [
                    /* Goals */Caml_chrome_debugger.variant("Goals", 5, [/* GetPointed */Caml_chrome_debugger.variant("GetPointed", 0, [(function (goal) {
                                return /* :: */Caml_chrome_debugger.simpleVariant("::", [
                                          /* SendRequest */Caml_chrome_debugger.variant("SendRequest", 8, [/* Context */Caml_chrome_debugger.variant("Context", 14, [
                                                  normalization$4,
                                                  goal
                                                ])]),
                                          /* [] */0
                                        ]);
                              })])]),
                    /* [] */0
                  ]);
      case /* GoalTypeAndContext */6 :
          var normalization$5 = command[0];
          return /* :: */Caml_chrome_debugger.simpleVariant("::", [
                    /* Goals */Caml_chrome_debugger.variant("Goals", 5, [/* GetPointed */Caml_chrome_debugger.variant("GetPointed", 0, [(function (goal) {
                                return /* :: */Caml_chrome_debugger.simpleVariant("::", [
                                          /* SendRequest */Caml_chrome_debugger.variant("SendRequest", 8, [/* GoalTypeAndContext */Caml_chrome_debugger.variant("GoalTypeAndContext", 15, [
                                                  normalization$5,
                                                  goal
                                                ])]),
                                          /* [] */0
                                        ]);
                              })])]),
                    /* [] */0
                  ]);
      case /* GoalTypeAndInferredType */7 :
          var normalization$6 = command[0];
          return /* :: */Caml_chrome_debugger.simpleVariant("::", [
                    /* Goals */Caml_chrome_debugger.variant("Goals", 5, [/* GetPointed */Caml_chrome_debugger.variant("GetPointed", 0, [(function (goal) {
                                return /* :: */Caml_chrome_debugger.simpleVariant("::", [
                                          /* SendRequest */Caml_chrome_debugger.variant("SendRequest", 8, [/* GoalTypeAndInferredType */Caml_chrome_debugger.variant("GoalTypeAndInferredType", 16, [
                                                  normalization$6,
                                                  goal
                                                ])]),
                                          /* [] */0
                                        ]);
                              })])]),
                    /* [] */0
                  ]);
      case /* InputSymbol */8 :
          var symbol = command[0];
          var enabled = atom.config.get("agda-mode.inputMethod");
          if (enabled) {
            return /* :: */Caml_chrome_debugger.simpleVariant("::", [
                      /* Activate */1,
                      /* :: */Caml_chrome_debugger.simpleVariant("::", [
                          /* WithInstance */Caml_chrome_debugger.variant("WithInstance", 0, [(function (instance) {
                                  var tmp;
                                  switch (symbol) {
                                    case /* Ordinary */0 :
                                        tmp = Curry._1(instance[/* view */1][/* activateInputMethod */9], true);
                                        break;
                                    case /* CurlyBracket */1 :
                                        tmp = Curry._1(instance[/* view */1][/* interceptAndInsertKey */10], "{");
                                        break;
                                    case /* Bracket */2 :
                                        tmp = Curry._1(instance[/* view */1][/* interceptAndInsertKey */10], "[");
                                        break;
                                    case /* Parenthesis */3 :
                                        tmp = Curry._1(instance[/* view */1][/* interceptAndInsertKey */10], "(");
                                        break;
                                    case /* DoubleQuote */4 :
                                        tmp = Curry._1(instance[/* view */1][/* interceptAndInsertKey */10], "\"");
                                        break;
                                    case /* SingleQuote */5 :
                                        tmp = Curry._1(instance[/* view */1][/* interceptAndInsertKey */10], "'");
                                        break;
                                    case /* BackQuote */6 :
                                        tmp = Curry._1(instance[/* view */1][/* interceptAndInsertKey */10], "`");
                                        break;
                                    case /* Abort */7 :
                                        tmp = Curry._1(instance[/* view */1][/* activateInputMethod */9], false);
                                        break;
                                    
                                  }
                                  return $$Promise.map(tmp, (function (param) {
                                                return /* Ok */Caml_chrome_debugger.variant("Ok", 0, [/* [] */0]);
                                              }));
                                })]),
                          /* [] */0
                        ])
                    ]);
          } else {
            return /* :: */Caml_chrome_debugger.simpleVariant("::", [
                      /* WithInstance */Caml_chrome_debugger.variant("WithInstance", 0, [(function (instance) {
                              Editors$AgdaMode.Focus.get(instance[/* editors */0]).insertText("\\");
                              return $$Promise.resolved(/* Ok */Caml_chrome_debugger.variant("Ok", 0, [/* [] */0]));
                            })]),
                      /* [] */0
                    ]);
          }
      case /* Jump */9 :
          var match = command[0];
          if (match.tag) {
            var index = match[0];
            return /* :: */Caml_chrome_debugger.simpleVariant("::", [
                      /* WithInstance */Caml_chrome_debugger.variant("WithInstance", 0, [(function (instance) {
                              var positions = Instance__Goals$AgdaMode.getPositions(instance);
                              Editors$AgdaMode.Focus.on(/* Source */0, instance[/* editors */0]);
                              Rebase.$$Option.forEach((function (position) {
                                      instance[/* editors */0][/* source */1].setCursorBufferPosition(position);
                                      return /* () */0;
                                    }), Rebase.$$Array.get(positions, index));
                              return $$Promise.resolved(/* Ok */Caml_chrome_debugger.variant("Ok", 0, [/* [] */0]));
                            })]),
                      /* [] */0
                    ]);
          } else {
            var range = match[0];
            return /* :: */Caml_chrome_debugger.simpleVariant("::", [
                      /* WithInstance */Caml_chrome_debugger.variant("WithInstance", 0, [(function (instance) {
                              var filePath = Instance__TextEditors$AgdaMode.getPath(instance);
                              var match;
                              if (range) {
                                var match$1 = range[0];
                                if (match$1 !== undefined) {
                                  var path = match$1;
                                  var match$2 = path === filePath;
                                  match = /* tuple */[
                                    true,
                                    match$2 ? undefined : path
                                  ];
                                } else {
                                  match = /* tuple */[
                                    true,
                                    undefined
                                  ];
                                }
                              } else {
                                match = /* tuple */[
                                  false,
                                  undefined
                                ];
                              }
                              var otherFilePath = match[1];
                              if (match[0]) {
                                if (otherFilePath !== undefined) {
                                  var match$3;
                                  if (range) {
                                    var match$4 = Rebase.$$Array.get(range[1], 0);
                                    if (match$4 !== undefined) {
                                      var i = match$4;
                                      match$3 = /* tuple */[
                                        i[/* start */0][/* line */1] - 1 | 0,
                                        i[/* start */0][/* col */2] - 1 | 0
                                      ];
                                    } else {
                                      match$3 = /* tuple */[
                                        0,
                                        0
                                      ];
                                    }
                                  } else {
                                    match$3 = /* tuple */[
                                      0,
                                      0
                                    ];
                                  }
                                  var option = {
                                    initialLine: match$3[0],
                                    initialColumn: match$3[1],
                                    split: "right",
                                    activatePane: true,
                                    activateItem: true,
                                    pending: false,
                                    searchAllPanes: true,
                                    location: undefined
                                  };
                                  return $$Promise.map($$Promise.Js.toResult($$Promise.Js.fromBsPromise(atom.workspace.open(otherFilePath, option))), (function (param) {
                                                if (param.tag) {
                                                  return /* Error */Caml_chrome_debugger.variant("Error", 1, [/* Cancelled */0]);
                                                } else {
                                                  return /* Ok */Caml_chrome_debugger.variant("Ok", 0, [/* [] */0]);
                                                }
                                              }));
                                } else {
                                  var ranges = Type__Location$AgdaMode.$$Range.toAtomRanges(range);
                                  if (Rebase.$$Option.isSome(Rebase.$$Array.get(ranges, 0))) {
                                    setTimeout((function (param) {
                                            instance[/* editors */0][/* source */1].setSelectedBufferRanges(ranges);
                                            return /* () */0;
                                          }), 0);
                                  }
                                  return $$Promise.resolved(/* Ok */Caml_chrome_debugger.variant("Ok", 0, [/* [] */0]));
                                }
                              } else {
                                return $$Promise.resolved(/* Ok */Caml_chrome_debugger.variant("Ok", 0, [/* [] */0]));
                              }
                            })]),
                      /* [] */0
                    ]);
          }
      
    }
  }
}

var Goals = 0;

var Highlightings = 0;

var Connections = 0;

var TextEditors = 0;

exports.Goals = Goals;
exports.Highlightings = Highlightings;
exports.Connections = Connections;
exports.TextEditors = TextEditors;
exports.handle = handle;
/* Promise Not a pure module */
